# æœ¬å‘¨å®‰å…¨:Linux WiFiã€Fortinetã€Text4Shell å’Œå¯é¢„æµ‹çš„ GUIDs

> åŽŸæ–‡:[https://hack aday . com/2022/10/21/this-week-in-security-Linux-wifi-fortinet-text 4 shell-and-predictable-guids/](https://hackaday.com/2022/10/21/this-week-in-security-linux-wifi-fortinet-text4shell-and-predictable-guids/)

æœ¬å‘¨é¦–å…ˆå…³æ³¨çš„æ˜¯ Linux å†…æ ¸æ— çº¿ä»£ç ä¸­çš„äº”ä¸ªæ¼æ´žã€‚å®ƒå§‹äºŽæ¥è‡ª [TU Darmstadt](https://en.wikipedia.org/wiki/Technische_Universit%C3%A4t_Darmstadt) çš„ã€Soenke Husterã€‘ï¼Œä»–åœ¨ mac80211 ä»£ç ä¸­å‘çŽ°äº†ç¼“å†²åŒºè¦†ç›–ã€‚å¯¹ SUSE å†…æ ¸å·¥ç¨‹å¸ˆçš„ç§ä¸‹æŠ«éœ²å¯¼è‡´äº†å¯¹å†…æ ¸ä¸­è¿™ä¸ªæ— çº¿æ¡†æž¶çš„å®‰å…¨æ£€æŸ¥ï¼Œå¹¶å‘çŽ°äº†ä¸€äº›å…¶ä»–ä»¤äººè®¨åŽŒçš„é”™è¯¯ã€‚å‡ ä¸ªå¯¼è‡´æ‹’ç»æœåŠ¡(DOS)ï¼Œä½† CVE-2022-41674ï¼ŒCVE-2022-42719 å’Œ CVE-2022-42720 æ˜¯è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›æ¼æ´žæ˜¯åœ¨å¤„ç†ä¿¡æ ‡å¸§(å®£å¸ƒæ— çº¿ç½‘ç»œå­˜åœ¨çš„æ— çº¿æ•°æ®åŒ…)æ—¶è§¦å‘çš„ã€‚æœºå™¨ä¸ä¸€å®šè¦è¿žæŽ¥æˆ–è¯•å›¾è¿žæŽ¥åˆ°ç½‘ç»œï¼Œä½†ç®€å•åœ°æ‰«æç½‘ç»œå¯èƒ½ä¼šå¯¼è‡´å±å®³ã€‚

13 å·å…¬å¸ƒäº†æ¼æ´žï¼Œ[15 å·](https://www.phoronix.com/news/Linux-6.0.2-Point-Releases-WiFi)åœ¨ä¸»çº¿å†…æ ¸æ­£å¼ä¿®å¤ã€‚è®¸å¤šå‘è¡Œç‰ˆ[åœ¨ 14 å·](https://bugzilla.redhat.com/show_bug.cgi?id=2134470)å‘å¸ƒäº†æ›´æ–°ï¼Œæ‰€ä»¥è¿™æ¬¡çš„è½¬å˜å¾ˆå¿«ã€‚è¿™äº›ç¼ºé™·éƒ½æ˜¯å†…å­˜ç®¡ç†é—®é¢˜ï¼Œè¿™ä¿ƒä½¿ä¸€äº›äººå‘¼åæ–°åˆå¹¶çš„ Rust æ¡†æž¶å°½å¿«åœ¨çŽ°å®žä¸–ç•Œä¸­å¾—åˆ°ä¸€äº›ä½¿ç”¨ã€‚

## Fortinet

Fortinet çš„å¤§éƒ¨åˆ†äº§å“ï¼Œæœ€è‘—åçš„æ˜¯ Fortigate é˜²ç«å¢™ï¼Œåœ¨ç®¡ç† HTTP/S æŽ¥å£ä¸Šæœ‰ä¸€ä¸ªé¢„æŽˆæƒè®¤è¯æ—è·¯ã€‚æˆ–è€…ç®€å•åœ°è¯´ï¼Œå¦‚æžœä½ èƒ½è¿›å…¥ç™»å½•é¡µé¢ï¼Œä½ å¯ä»¥ä¸éœ€è¦å¯†ç å°±èƒ½è¿›å…¥ã€‚è¿™å¾ˆç³Ÿç³•ï¼Œä½†æ˜¯åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œä½ çœŸçš„ä¸åº”è¯¥åœ¨ä»»ä½•ç¡¬ä»¶ä¸Šæœ‰ä»»ä½•å…¨çƒé€šç”¨çš„ç®¡ç†ç•Œé¢ã€‚æ›´æ–°çš„å›ºä»¶å¯ç”¨ã€‚

å‡ å¤©è¿‡åŽ»äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹[çš„æ ¹æœ¬é—®é¢˜å’Œå¦‚ä½•ä¿®å¤](https://www.horizon3.ai/fortios-fortiproxy-and-fortiswitchmanager-authentication-bypass-technical-deep-dive-cve-2022-40684/)æœ‰äº†ä¸€äº›äº†è§£ã€‚è¿™å¾ˆç®€å•â€”â€”ä¼ å…¥è¯·æ±‚ä¸Šè½¬å‘çš„ HTTP å¤´è¢«æ— æ„åœ°ä¿¡ä»»ã€‚å› æ­¤ï¼Œåªéœ€å‘é€ä¸€ä¸ªå°†`Forwarded:for`å’Œ`Forwarded:by`è®¾ç½®ä¸º 127.0.0.1 çš„è¯·æ±‚ï¼Œå®ƒå°±ä¼šè½å…¥ç”¨äºŽå†…éƒ¨ API è°ƒç”¨çš„ä»£ç é€»è¾‘ä¸­ã€‚æ·»åŠ ä¸€ä¸ªå¯ä¿¡çš„ SSH å¯†é’¥ï¼Œç„¶åŽç °çš„ä¸€å£°ï¼Œä½ å°±æˆåŠŸäº†ã€‚å“Žå‘¦ã€‚

## GitHub ä»¤ç‰Œå­¦ä¹ æ–°æŠ€å·§

GitHub å·²ç»å°± SSH è¿žæŽ¥åˆ°ä»–ä»¬çš„æœåŠ¡çš„å¯†ç ä½¿ç”¨å‘èµ·äº†ä¸€åœºå°å°çš„æˆ˜äº‰ã€‚è¿™æœ‰ä¸€äº›æ˜¾è€Œæ˜“è§çš„å¥½å¤„ï¼Œä½†ç¼ºç‚¹ä¹‹ä¸€æ˜¯ä»¤ç‰Œä¼šæ°¸ä¹…åœ°å®‰è£…åœ¨æ‚¨çš„å¼€å‘æœºå™¨ä¸Šï¼Œå®ƒå¯ä»¥è®¿é—®æ‚¨çš„æ•´ä¸ª GitHub å¸æˆ·ã€‚å¦‚æžœä½ åœ¨å…±äº«æœåŠ¡å™¨ä¸Šåšä»»ä½•å¼€å‘å·¥ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªçœŸæ­£çš„é—®é¢˜ã€‚å¹¸è¿çš„æ˜¯ï¼ŒGitHub çš„äººä»¬å·²ç»è®¤è¯†åˆ°äº†ä»–ä»¬çš„é”™è¯¯ï¼Œå¹¶ä¸ºè¿™äº›ä»¤ç‰ŒæŽ¨å‡ºäº†æ›´å…·é€‰æ‹©æ€§çš„è®¿é—®æŽ§åˆ¶ã€‚å¯èƒ½æ˜¯æ—¶å€™åŽ»å®¡è®¡ä½ çš„ GitHub ä»¤ç‰Œäº†ï¼Œæ’¤é”€â€œç»å…¸â€ä»¤ç‰Œï¼Œé‡æ–°ç”Ÿæˆä¸¥æ ¼çš„æŽ§åˆ¶ã€‚

## Text4Shell

å¦‚æžœæœ‰ä»€ä¹ˆæ¯”è¯•å›¾é€šè¿‡åœ¨æ”¿æ²»ä¸‘é—»çš„æœ«å°¾åŠ ä¸Šâ€œgateâ€æ¥è®©æ”¿æ²»ä¸‘é—»çœ‹èµ·æ¥æ›´ç³Ÿç³•çš„è¯ï¼Œé‚£å°±æ˜¯ç»™ Java æ¼æ´žæ·»åŠ â€œ4shellâ€çš„æ–°è¶‹åŠ¿ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ text4shellã€‚å¥‡æ€ªçš„æ˜¯ï¼Œ`StringSubstitutor.replace()`å’Œ`StringSubstitutor.replaceIn()`å¯ä»¥å¯¹åŒ…å«çš„å­—ç¬¦ä¸²è¿›è¡Œå­—ç¬¦ä¸²æŸ¥æ‰¾â€”â€”å¹¶ä¸”è¿™ç§æŸ¥æ‰¾å¯ä»¥è¿è¡Œä»»æ„çš„ Java ä»£ç :

`final StringSubstitutor interpolator = StringSubstitutor.createInterpolator();
String out = interpolator.replace("${script:javascript:java.lang.Runtime.getRuntime().exec('touch /tmp/foo')}");
System.out.println(out);`

æœ‰ä¸€æ®µæ—¶é—´çœ‹èµ·æ¥çŽ°ä»£ JDK ç‰ˆæœ¬æ²¡æœ‰å—åˆ°å½±å“ï¼Œä½†ç»“æžœæ˜¯ä¸€ç§ç¨å¾®ä¸åŒçš„æ–¹æ³•ç»™æˆ‘ä»¬å¸¦æ¥äº†å®Œå…¨ç›¸åŒçš„ä»£ç æ‰§è¡Œé—®é¢˜ã€‚

> ä½ å¥½ï¼ŒErikï¼Œæˆ‘æ”¶åˆ°äº†ä¸€äº›å…³äºŽå—æ­¤æ¼æ´žå½±å“çš„ JDK ç‰ˆæœ¬çš„é—®é¢˜ã€‚èƒ½å¦è¯·ä½ æ›´æ–°ä½ çš„åšå®¢å¸–å­ï¼Œä»¥è¡¨æ˜Žæ‰€æœ‰ JDK ç‰ˆæœ¬éƒ½å®¹æ˜“å—åˆ°æ”»å‡»ï¼Ÿçº³æ–¯éœæ©åœ¨çŽ°ä»£ JDK ä¸­å®žé™…ä¸Šæ˜¯ä¸å¯ç”¨çš„ï¼Œä½†æ°å…‹æ–¯æ˜¯ pic.twitter.com/rY2J9VEZrX
> 
> â€”é˜¿å°”ç“¦ç½—Â·ç©†å°¼å¥¥æ–¯Â·ðŸ‡ºðŸ‡¦(@ pwntester)[2022 å¹´ 10 æœˆ 18 æ—¥](https://twitter.com/pwntester/status/1582321752566161409?ref_src=twsrc%5Etfw)