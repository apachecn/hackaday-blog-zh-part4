# æœ¬å‘¨å®‰å…¨:Y2K22ï¼Œæ„å¤–é˜»å¡ 911ï¼Œå’Œé”™è¯¯è­¦æŠ¥

> åŸæ–‡ï¼š<https://hackaday.com/2022/01/07/this-week-in-securityy2k22-accidentally-blocking-911and-bug-alert/>

å¦‚æœä½ åœ¨è¿‡å»çš„ä¸€å‘¨é‡Œä¸å¹¸è¿è¡Œäº†å¾®è½¯çš„ Exchange æœåŠ¡å™¨ï¼Œé‚£ä¹ˆä½ ä¸éœ€è¦æˆ‘[å‘Šè¯‰ä½ å…³äº Y2K22 é—®é¢˜](https://arstechnica.com/information-technology/2022/01/exchange-server-bug-gets-a-fix-after-ruining-admins-new-years-plans/)ã€‚ä¸ºäº†èµ¶ä¸Šæˆ‘ä»¬ï¼Œå½“ Exchange è¯•å›¾ä¸‹è½½ 2022 å¹´çš„ç¬¬ä¸€ä¸ªæ¶æ„è½¯ä»¶å®šä¹‰æ›´æ–°æ—¶ï¼Œæ–°å®šä¹‰çš„ç‰ˆæœ¬å·è§¦å‘äº†æ¶æ„è½¯ä»¶æ£€æµ‹å¼•æ“çš„å´©æºƒã€‚æ—¥æœŸè¡¨ç¤ºä¸ºå­—ç¬¦ä¸²`2201010001`ï¼Œå…¶ä¸­å‰ä¸¤ä½æ•°å­—è¡¨ç¤ºå¹´ä»½ã€‚è¿™ä¸ªå­—ç¬¦ä¸²è¢«è½¬æ¢æˆä¸€ä¸ªæœ‰ç¬¦å·çš„é•¿æ•´æ•°ï¼Œåœ¨`2,147,483,647`è¾¾åˆ°æœ€å¤§å€¼ã€‚æ•´æ•°æº¢å‡ºï¼Œç»“æœæ˜¯æœªå®šä¹‰çš„è¡Œä¸ºï¼Œä½¿å¼•æ“å´©æºƒã€‚æœåŠ¡å™¨æ•…éšœå®‰å…¨ï¼Œä¸å¤„ç†ä»»ä½•æ²¡æœ‰å·¥ä½œçš„æ¶æ„è½¯ä»¶å¼•æ“çš„æ¶ˆæ¯ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰ç”µå­é‚®ä»¶é€šè¿‡ã€‚æ–°å¹´å¿«ä¹ï¼

## Android 911 æ‹’ç»æœåŠ¡

æ‹¨æ‰“ 911 å¯»æ±‚ç´§æ€¥æœåŠ¡å‡ ä¹æ˜¯è½¯ä»¶æ¼æ´æ˜¾ç°çš„æœ€ç³Ÿç³•çš„æ—¶é—´ã€‚è°·æ­Œåˆšåˆšåœ¨ 1 æœˆä»½çš„ Android æ›´æ–°ä¸­ä¿®å¤äº†è¿™æ ·ä¸€ä¸ª bugã€‚è¿™æ˜¯ä¸€ç§å¥‡æ€ªçš„æ„æƒ³ä¸åˆ°çš„åº”ç”¨ç¨‹åºäº¤äº’â€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾®è½¯å›¢é˜Ÿè§¦å‘äº† Android bugã€‚å¦‚æœå®‰è£…äº† Teams åº”ç”¨ç¨‹åºï¼Œä½†æ²¡æœ‰å¸æˆ·ç™»å½•ï¼ŒTeams ä¼šåœ¨æ¯æ¬¡å¯åŠ¨æ—¶åˆ›å»ºå¹¶æ³¨å†Œä¸€ä¸ªæ–°çš„`PhoneAccount`å¯¹è±¡ã€‚è¿™å¬èµ·æ¥å¾ˆå°‘è§ï¼Œä½†æ˜¯ Android ä¸Šçš„å›¢é˜Ÿä¹Ÿå› ä¸ºè‡ªå‘æ³¨é”€ç”¨æˆ·è€Œè‡­åæ˜­è‘—ã€‚å½“ä½ æ‹¨æ‰“ 911 æ—¶ï¼ŒAndroid è¿è¡Œä¸€ä¸ªä¾‹ç¨‹æ¥ç¡®å®šåº”è¯¥ä½¿ç”¨å“ªä¸ª`PhoneAccount`æ¥è·¯ç”±å‘¼å«ï¼Œå¹¶é€šè¿‡æ¯”è¾ƒå“ˆå¸Œå€¼æ¥è§£å†³å¹³å±€ã€‚è¿™ç§æ¯”è¾ƒåªæ˜¯ä¸€ç§å¹¼ç¨šçš„å‡æ³•ï¼Œæ„å‘³ç€æœ‰ 50%çš„æœºä¼šå¾—åˆ°å¦å®šçš„ç»“æœã€‚è¿™æ˜¯æ²¡æœ‰é¢„æ–™åˆ°çš„ï¼Œå¯¼è‡´äº†å´©æºƒã€‚

## è½¦åº“é—¨é€†å‘å·¥ç¨‹

å¯¹ä¸€ä¸ªæœ‰ 30 å¹´å†å²çš„æ— çº¿æˆæƒæ–¹æ¡ˆè¿›è¡Œé€†å‘å·¥ç¨‹å¯èƒ½ä¸æ˜¯æœ€å¼•äººæ³¨ç›®çš„å£®ä¸¾ï¼Œä½†æœ‰æ—¶è¿™ä¸ªè¿‡ç¨‹æœ¬èº«å°±æ˜¯ä¸€ç§å¥–åŠ±ã€‚[éº¦å…‹æ–¯éŸ¦Â·æœæ—]ç»™æˆ‘ä»¬å¸¦æ¥äº†è¿™ä¸ªæ•…äº‹ï¼Œè¿™æ¬¡æ—…è¡Œå½“ç„¶æ˜¯å€¼å¾—çš„ã€‚è¿™ç§æ”»å‡»çš„åŸºæœ¬åŸç†ä»ç„¶æ˜¯å¯è¡Œçš„ï¼Œä»ç¡¬ä»¶å¼€å§‹ã€‚å‘é€ä»£ç æ—¶æŒ‰ä½æ¥æ”¶å™¨ä¸Šçš„æŒ‰é’®ï¼Œè½¦åº“é—¨ä¸è½¦åº“é—¨é¥æ§æ¥æ”¶å™¨åŒæ­¥ã€‚å¼€å¯å™¨å†…æœ‰ä¹ä¸ªåŒåˆ—ç›´æ’å¼å¼€å…³ï¼Œæ¯ä¸ªå¼€å…³æœ‰ä¸‰ä¸ªä½ç½®ã€‚ä»–ä»¬æ˜¯åšä»€ä¹ˆçš„ï¼Ÿä»–æ‹¿å‡ºä»–å€¼å¾—ä¿¡èµ–çš„ SDR æ¥è·å–æµé‡ï¼Œå¹¶è¯•å›¾è§£ç ä¿¡å·ã€‚Inspectrum å’Œ GNU Radio æ˜¯è¿™é‡Œçš„è‹±é›„ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£è¿™ä¸ªç®€å•çš„è®¤è¯æ–¹æ¡ˆã€‚å…³äºè¿™ä¸ªçœŸæ­£çš„è½¦åº“é—¨çš„ç»“è®ºï¼Ÿä½ å¯ä»¥é€šè¿‡å‘é€æ¯ä¸€ä¸ªå¯èƒ½çš„è¿å‡»æ¥æš´åŠ›ç ´è§£ä¸€ä¸ªæœªçŸ¥ä»£ç ï¼Œè€Œä¸”åªéœ€è¦ 104 åˆ†é’Ÿã€‚

## é”™è¯¯è­¦æŠ¥

å¦‚æœæ‚¨æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‚¨çŸ¥é“æœ‰äº›é—®é¢˜éœ€è¦ç«‹å³é‡‡å–è¡ŒåŠ¨ã€‚å¦‚æœæ‚¨è¿è¡Œ Java æœåŠ¡å™¨ï¼ŒLog4J æ¼æ´æ˜¯å¯¹æ‚¨çš„å“åº”åè®®çš„ä¸€ä¸ªè€ƒéªŒã€‚ä»å…¬å¼€æŠ«éœ²åˆ°ä½ å¬åˆ°å®ƒçš„æ—¶é—´ï¼Œå¯èƒ½å·²ç»è¶³å¤Ÿå¼•å‘ç¾éš¾ã€‚è™½ç„¶æœ‰å¤šç§é”™è¯¯æŠ¥å‘ŠæœåŠ¡å’Œæ¡†æ¶ï¼Œä½†æ²¡æœ‰ä¸€ç§éå¸¸é€‚åˆè¿™ç§åˆ©åŸºç”¨ä¾‹:å°½å¿«é€šçŸ¥æ‚¨æ‚¨çš„å¤´å‘å¯èƒ½çœŸçš„ç€ç«äº†ã€‚è¿™ä¸ªç©ºç¼ºçš„èŒä½å¸å¼•äº†é©¬ä¿®Â·æ²™åˆ©æ–‡ï¼Œä»–å®£å¸ƒäº†ä¸€ä¸ªæ–°é¡¹ç›®ï¼ŒBug Alertã€‚å®ƒéƒ½æ˜¯å¼€æºçš„ï¼Œæ‰€ä»¥å¦‚æœä½ çœŸçš„æƒ³çš„è¯ï¼Œä½ å¯ä»¥æ‰˜ç®¡ä½ è‡ªå·±çš„å®ä¾‹ã€‚ä½ å¯ä»¥é€‰æ‹©å‘æ¨æ–‡ï¼Œå‘çŸ­ä¿¡ï¼Œç”šè‡³æ‰“ç”µè¯ã€‚è¿™æœ‰å¯èƒ½æˆä¸ºä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·ï¼Œçœ‹çœ‹å§ï¼

æˆ‘è§‰å¾—æˆ‘éœ€è¦è®© Bug è­¦æŠ¥è§¦å‘[ä¸€é¦–å¥‡æ€ªçš„è‰¾å°”æ­Œæ›²â€¦â€¦](https://www.youtube.com/watch?v=zvfD5rnkTws)

## åƒµå°¸ SSRF

[David SchÃ¼tz]æ­£åœ¨[æœç´¢æ™¦æ¶©éš¾æ‡‚çš„è°·æ­Œ API](https://bugs.xdavidhu.me/google/2021/12/31/fixing-the-unfixable-story-of-a-google-cloud-ssrf/)ï¼Œå¹¶å‘ç°äº†`jobs.googleapis.com`ï¼Œä½ å¯ä»¥è‡ªå·±æ¼”ç¤ºã€‚è¿™ä¸ªæ¼”ç¤ºå¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªå®Œå…¨å……å®çš„æœåŠ¡ï¼Œè€Œæ˜¯ä¸çœŸæ­£çš„åç«¯å¯¹è¯ã€‚è¯·æ±‚é€šè¿‡ä»£ç†`cxl-services.appspot.com`ï¼Œå®ƒå¤„ç†æ¼”ç¤ºé¡µé¢çš„è®¤è¯æ­¥éª¤ã€‚å¦‚æœä»–èƒ½è§¦å‘ä¸€ä¸ªæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ (SSRF)ï¼Œä»–ä¹Ÿè®¸èƒ½å¾—åˆ°ç»è¿‡éªŒè¯çš„è¯·æ±‚ï¼Œä¹Ÿè®¸èƒ½æ¬ºéª—ä»£ç†ä»£è¡¨ä»–å‘é€æµé‡ã€‚URL è§£æå¾ˆéš¾ã€‚æˆåŠŸçš„è¯€çªï¼Ÿurl ä¸­çš„åæ–œæ ã€‚`GET /proxy?url=https://sfmnev.vps.xdavidhu.me\@jobs.googleapis.com/ HTTP/1.1`

æ‰‹é‡Œæ‹¿ç€ä¸€ä¸ªè®¿é—®ä»¤ç‰Œï¼Œ[David]å¼€å§‹ä»”ç»†ç ”ç©¶å…¶ä»– Google APIsï¼Œçœ‹çœ‹è¿™ä¸ªä»¤ç‰Œè®©ä»–å¯ä»¥è®¿é—®ä»€ä¹ˆã€‚ä»–ç»™å‡ºäº†æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡çš„è­¦å‘Šï¼Œå°å¿ƒä½ æ¨çš„è·ç¦»ã€‚ä»–æœ¬å¯ä»¥ç«‹å³æŠ¥å‘Šè¿™ä¸ª bugï¼Œä½†æ˜¯æƒ³è¦ç¡®è®¤ä»–å®é™…ä¸Šæœ‰ä¸€ä¸ªå®æ—¶è®¿é—®ä»¤ç‰Œã€‚åœ¨ç¡®è®¤ä»¤ç‰Œå¯ç”¨äºè¯»å–è®¿é—®åï¼Œä»–ä¸Šäº¤äº†è¿™ä¸€å‘ç°ï¼Œå‡€èµšäº† 3133.70 ç¾å…ƒï¼Œæ­¤å¤–è¿˜å› å‡ºè‰²çš„æŠ¥å‘Šå’Œå¯¹æ¨ªå‘ç§»åŠ¨çš„ä»”ç»†è§‚å¯Ÿè·å¾—äº† 1000 ç¾å…ƒçš„é¢å¤–å¥–åŠ±ã€‚ä»…æ­¤è€Œå·²ï¼Œå¯¹å§ï¼Ÿæ²¡æœ‰ã€‚å°±åœ¨ 90 å¤©æŠ«éœ²æˆªæ­¢æ—¥æœŸä¹‹å‰ï¼Œ[David]å‘ç°äº†ä¸€ä¸ªä¿®å¤æ—è·¯ã€‚åœ¨åæ–œæ å’Œ@ä¹‹é—´æ·»åŠ ä»»ä½•æ–‡æœ¬éƒ½è¶³ä»¥æ‰“ç ´å®ƒã€‚åˆæ˜¯ 3133.70 ç¾å…ƒã€‚åªæ˜¯ä¸ºäº†å¥½ç©ï¼Œä»–æ¢æµ‹äº†æ—§çš„ç½‘å€ï¼Œä¿®å¤åä¸åº”è¯¥åœ¨æœåŠ¡ä¸­ã€‚æ˜¯çš„ï¼Œä»–å‘ç°äº†å¦ä¸€ä¸ªå®‰å…¨ä»¤ç‰Œï¼Œå‡€èµšäº† 3133.70 ç¾å…ƒã€‚è¿™ä¸ªåƒµå°¸ SSRF è¿˜æ²¡æ­»ï¼Œ[æ¨ç‰¹ä¸Šçš„è¯æ®](https://twitter.com/xdavidhu/status/1477664931877163010):

> æˆ‘å‘Šè¯‰è¿‡ä½ ï¼Œå®ƒæ˜¯ä¸å¯ä¿®å¤çš„ï¼ [@n1nj4sec](https://twitter.com/n1nj4sec?ref_src=twsrc%5Etfw) å·²ç»ç»•è¿‡äº†ä¿®å¤ã€‚å¤ªé…·äº†ï¼ä½ ä¼šæ˜¯ç¬¬å››ä¸ªç»•è¿‡å®ƒå¹¶è·å¾—$3k çš„äººå—ï¼ŸğŸ˜è§£æä¸€ä¸ªç½‘å€çœŸçš„å¾ˆéš¾ã€‚pic.twitter.com/5xmg5tbybw
> 
> â€”å¤§å«Â·èˆ’èŒ¨(@ xdavidhu)[2022 å¹´ 1 æœˆ 2 æ—¥](https://twitter.com/xdavidhu/status/1477664931877163010?ref_src=twsrc%5Etfw)